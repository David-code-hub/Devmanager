$(document).ready(function(){function a(){e||(d.fadeOut(200),e=!1)}checkPromo(),updateCartCount(),$(document).on("click","#closeSearch",function(){$("#search").parent().addClass("closed"),$("#search").val(""),$("#search-dropdown").hide(),clearSearchDropdown()});var b=0;$(document).on("keyup","#search",function(a){if(3<=$(this).val().length){b&&clearTimeout(b);var c=$(this).val(),d=a.which,e=$(this).data("search-url");13==d&&(e=e.replace("__query__",encodeURIComponent(c)),window.location.href=e),b=setTimeout(function(){$.ajax({url:"/search",method:"POST",data:{query:c},beforeSend:function beforeSend(a){a.setRequestHeader("Csrf-Token",$("input[name=csrfToken]").val())},success:function success(a){$("#search").parent().removeClass("closed"),clearSearchDropdown(),fillSearchDropdown(c,a),$("#search-dropdown").show()},error:function error(){}})},300)}else $("#search").parent().addClass("closed"),$("#search-dropdown").hide()}),$(document).on("focus","#search",function(){3<=$(this).val().length?($("#search").parent().removeClass("closed"),$("#search-dropdown").show()):($("#search").parent().addClass("closed"),$("#search-dropdown").hide())});var c=$(".show-on-hover"),d=$(".show-on-hover .dropdown-menu__container"),e=!1;c.hover(function(){e=!0,d.fadeIn(200,function(){})},function(){e=!1,setTimeout(a,500)})}),$(window).on("load",function(){"#login"===window.location.hash&&$("#profile-header-btn").length&&openSigninModal(),"#login"!==window.location.hash||$("#profile-header-btn").length||(window.location.href="/profile/settings")}),$(document).on("keyup","#forgotEmail",function(){""===$("#forgotEmail").val()?$("#forgotButton").addClass("disabled"):$("#forgotButton").removeClass("disabled")}),$(document).on("click","#forgotButton",function(){$.ajax({url:"/forgot",method:"POST",data:{email:$("#forgotEmail").val()},beforeSend:function beforeSend(a){a.setRequestHeader("Csrf-Token",$("input[name=csrfToken]").val())},success:function success(){toastr.success("Check your email","",{positionClass:"toast-top-center"}),setTimeout(function(){$("#forgetReturn").click()},1e3)},error:function error(){toastr.error("No such email","",{positionClass:"toast-top-center"})}})});function clearSearchDropdown(){$("#search-dropdown").find(".dropdown__item").each(function(){$(this).remove()})}function fillSearchDropdown(a,b){// items - {text: '', link: ''}. Who the f*ck are you?
var c=a.replaceAll("<","&lt;").replaceAll(">","&gt;");$("#search-dropdown").append("<a href=\"/search?query="+encodeURIComponent(a)+"\" class=\"dropdown__item\">All results for \""+c+"\"</a>"),b.forEach(function(b){var c="producer";b.link.includes("tags")&&(c="tags"),b.link.includes("#")&&(c="track"),$("#search-dropdown").append("<a href=\"javascript:void(0)\" onclick=\"gosearch('"+b.link+"', '"+a+"')\" class=\"dropdown__item "+c+"\">"+b.text+"</a>")})}function gosearch(a){//gtag('event', 'search', {'event_category': 'search', 'event_label': query});
if(2>a.split("#").length)window.location.href=a;else{var b=a.split("#")[0],c=a.split("#")[1];b===window.location.pathname?selectTrack(c):window.location.href=a}}var animation_active_note=!1;$(document).on("click",".sign-in-submit",function(){var a=$("input[name=loginUsername]").closest("form").serialize(),b=$("input[name=redirect]").val();$.ajax({url:"/login",method:"POST",data:a,beforeSend:function beforeSend(a){a.setRequestHeader("Csrf-Token",$("input[name=csrfToken]").val())},success:function success(){window.dataLayer=window.dataLayer||[],dataLayer.push({event:"logged"}),b?(window.location.href=b,window.location.reload()):window.location.href="/auth/redirect"},error:function error(a){$("#loginModal").html(a.responseText),toastr.error("Incorrect username or password","",{positionClass:"toast-top-center"})}})}),$(document).on("click",".login-from-faq",function(a){openSigninModal(a)}),$(document).on("click","#profile-header-btn",function(a){openSigninModal(a)});function openSigninModal(a,b){a&&a.preventDefault(),$.ajax({url:"/login"+(b?"?redirect="+encodeURIComponent(b):""),method:"GET",success:function success(a){$("#loginModal").html(a);var b=$("#loginModal").remodal();b.open()},error:function error(){toastr.error("Checkout error occured. Please contact administration","",{positionClass:"toast-top-center"})}},"html")}function openRegActionModal(a){a&&a.preventDefault();var b=$("div[data-remodal-id=\"role-action\"]").remodal();b.open()}function capitalize(a){return a[0].toUpperCase()+a.slice(1)}function blogVisitFooter(){//gtag('event', 'footer-click', {'event_category': 'blog', 'event_label': 'Footer'});
return!0}function socialVisitFooter(){//gtag('event', social+'-footer', {'event_category': 'social', 'event_label': capitalize(social)});
return!0}function requestInviteVisit(){//gtag('event', 'click', {'event_category': 'invitation', 'event_label': 'login'});
return!0}function checkPromo(){}(function(){var a=new XMLHttpRequest;a.open("GET","/promos",!1),a.send();var b=JSON.parse(a.responseText);if(0<b.length&&0===document.getElementsByClassName("member-page").length){var c=b[0],d=c.name.toLowerCase().replace(/ /g,"-");document.body.classList.add("promotion"),document.body.classList.add("promotion--"+d),headerLogo=document.getElementsByClassName("header--logo__top")[0],headerLogo&&(headerLogo.children[0].setAttribute("src","https://d3e09417dac3bi.cloudfront.net/"+c.logo),document.getElementsByClassName("header--logo__link")[0].setAttribute("data-href",c.link))}})(),$(function(){var a=0});var checkFeaturedSecLength=function(){function a(a,b){var c,d;b.querySelector(".text-"+a+"-wrapper").addEventListener("mouseover",function(){clearTimeout(c),b.querySelector(".beat-grid__"+a+"-tooltip").classList.add("ready-to-show"),d=setTimeout(function(){b.querySelector(".beat-grid__"+a+"-tooltip").style.opacity=1},100)}),b.querySelector(".text-"+a+"-wrapper").addEventListener("mouseleave",function(){clearTimeout(d),b.querySelector(".beat-grid__"+a+"-tooltip").style.opacity=0,c=setTimeout(function(){b.querySelector(".beat-grid__"+a+"-tooltip").classList.remove("ready-to-show")},600)})}for(var b=document.getElementsByClassName("beat-grid__text"),c=0;c<b.length;c++){var d=b[c],e=b[c].querySelector(".text-label-wrapper"),f=e.querySelector(".beat-grid__label"),g=b[c].querySelector(".text-producer-wrapper"),h=g.querySelector(".beat-grid__producer");e.clientHeight<f.clientHeight&&(d.classList.add("label-tooltip-on"),a("label",d));g.clientHeight<h.clientHeight&&(d.classList.add("producer-tooltip-on"),a("producer",d))}},checkRunningLine=function(){var a=0,b=0,c=function(c){var d=$(c).find("._js-title-for-running-string");d.each(function(){var d=$(this).parent(".beat-list__info").parent(".beat-list"),e=$(this).width(),f=$(this).find(".title__name"),g=$(this).find(".title__author"),h=$(this),i=function(f,g,h,i){var j=f.width();if(h<j){var k=0,l=function(){var a=f.position(),b=a.left;+b>+("-"+j)?(k=b-2,f.css("left",k+"px")):f.css("left",h+"px")};".js-player-container"===c&&(f.css("left",e+"px"),"name"==g&&(a=setInterval(l,20)),"author"==g&&(f.css("left",e+"px"),b=setInterval(l,20))),"name"==g?(i.addClass("running-name"),f.mouseenter(function(){d.addClass("show-name-tooltip")}),f.mouseleave(function(){d.removeClass("show-name-tooltip")})):"author"==g&&(i.addClass("running-author"),f.mouseenter(function(){d.addClass("show-author-tooltip")}),f.mouseleave(function(){d.removeClass("show-author-tooltip")}))}},j=function(c,d,e,f){var g=c.width();e>=g&&("name"==d&&(c.css("left","0px"),clearInterval(a),a=0,f.removeClass("running-name")),"author"==d&&(c.css("left","0px"),clearInterval(b),b=0,f.removeClass("running-author")))};(function runningString(a,b,d,e){e.hasClass("running-name")||i(a,"name",d,e),e.hasClass("running-author")||i(b,"author",d,e),e.hasClass("running-name")&&".js-player-container"===c&&j(a,"name",d,e),e.hasClass("running-author")&&".js-player-container"===c&&j(b,"author",d,e)})(f,g,e,h)})};c(".stations-sec"),c(".js-player-container"),$(document).find(".stations-sec").on("DOMSubtreeModified",function(){c(".stations-sec")}),$(document).find("._js-title-for-running-string").on("DOMSubtreeModified",function(){c(".js-player-container")})};function loadLazyVideos(){var a=[].slice.call(document.querySelectorAll("video.lazy"));if("IntersectionObserver"in window){console.log("IntersectionObserver in window");var b=new IntersectionObserver(function(a){a.forEach(function(a){if(a.isIntersecting){for(var c in a.target.children){var d=a.target.children[c];"string"==typeof d.tagName&&"SOURCE"===d.tagName&&(d.src=d.dataset.src)}a.target.load(),console.log("lazy video load"),a.target.classList.remove("lazy"),b.unobserve(a.target)}})});b.POLL_INTERVAL=100,a.forEach(function(a){console.log("lazy video observe"+a),b.observe(a)})}}function loadLazyImages(){// lazy load images
var a=[].slice.call(document.querySelectorAll("img.lazy"));if("IntersectionObserver"in window){var b=new IntersectionObserver(function(a){a.forEach(function(a){if(a.isIntersecting){var c=a.target;c.src=c.dataset.src,c.hasOwnProperty("data-srcset")&&(c.srcset=c.dataset.srcset),c.classList.remove("lazy"),b.unobserve(c)}})});a.forEach(function(a){b.observe(a)})}else;}document.addEventListener("DOMContentLoaded",function(){loadLazyImages(),loadLazyVideos()});function openOnlyForProducerModal(a){a&&a.preventDefault();var b=$("[data-remodal-id=\"only-for-producer\"]").remodal();b.open()}