// prepare contact modal vars
var captchaWidgetId,IS_SENDING=!1;$(window).on("load",function(){$("#myCaptcha iframe").length||(captchaWidgetId=grecaptcha.render("myCaptcha",{sitekey:"6LfmENMUAAAAANjvOBo516oxee_oRjlOF8gXvNQw",theme:$("#myCaptcha").attr("data-theme")}))}),$(document).on("click",".contact-user-button",function(){var a=$("#contactUserModal").remodal();a.open();// open contact-user modal window
var b=$(this).attr("data-user-id"),c=$(this).attr("data-username");// user to send message
// username or artist name
$("#contactUserId").val(b),$("#contactUserHeader").text(c),$("#contactUserMessage").val(""),$("#submitContactUser").addClass("disabled"),$("#submitContactUser").html("Send")}),$(document).on("keyup","#contactUserMessage",function(){""===$(this).val()?$("#submitContactUser").addClass("disabled"):$("#submitContactUser").removeClass("disabled")}),$(document).on("click","#submitContactUser",function(){var a=$("#contactUserId").val(),b=$("#contactUserMessage").val(),c=$("#g-recaptcha-response").val(),d=$("#contactUserModal").remodal();c||toastr.error("Failed to verify Captcha","",{positionClass:"toast-top-center"}),""!=b&&!IS_SENDING&&c&&(IS_SENDING=!0,$("#submitContactUser").html("Sending..."),$("#submitContactUser").addClass("disabled"),$.ajax({url:"/user/contact",method:"POST",data:{userId:a,message:b,"g-recaptcha-response":c},beforeSend:function beforeSend(a){a.setRequestHeader("Csrf-Token",$("input[name=csrfToken]").val())},success:function success(){IS_SENDING=!1,$("#submitContactUser").html("Sent"),toastr.success("Message has sent","",{positionClass:"toast-top-center"}),d.close(),grecaptcha.reset(captchaWidgetId)},error:function error(a){console.log(a),IS_SENDING=!1,$("#submitContactUser").html("Not sent"),"Captcha"===a.responseText?toastr.error("Captcha verification has failed","",{positionClass:"toast-top-center"}):toastr.error("Failed to send message","",{positionClass:"toast-top-center"}),grecaptcha.reset(captchaWidgetId)}}))}),$(document).ready(function(){$("body").bind("copy paste",function(a){if($("#contactUserMessage").is(":focus"))return a.preventDefault(),!1})});