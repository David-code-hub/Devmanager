function cleanRemodalClasses(){var a=$(".js-free-download-remodal");a.removeClass("remodal--free-download-success"),a.removeClass("remodal--free-download-subscribe"),a.removeClass("remodal--free-download-email")}function addEmailFormListener(){$(".js-social-email-submit").click(function(){if(!$(this).hasClass("disabled")){var a=$(".js-social-email-form").serialize();$.ajax({url:"/social-download-email/"+socialDownloadTrackId,method:"POST",data:a,success:function success(a){var b=$(a).find(".js-download-link").data("link");showSuccess(b)},error:function error(a){$(".js-socials-step1").html(a.responseText),addEmailFormListener()}},"html")}}),$(".js-social-email-terms").change(function(){$(this).prop("checked")?$(".js-social-email-submit").removeClass("disabled"):$(".js-social-email-submit").addClass("disabled")})}function showSuccess(a){if($(".js-socials-step1").hide(),$(".js-socials-popup-title").hide(),cleanRemodalClasses(),$(".js-free-download-remodal").addClass("remodal--free-download-success"),$(".js-socials-step-success").show(),"undefind"!=typeof $(".data-follow")){var b=$(".data-follow");b.removeClass("data-follow"),b.addClass("data-unfollow"),b.text("unfollow")}var c=$(".js-socials-download-link");c.attr("href",a),c.click(function(){$(".js-socials-close").click()})}$("[data-popup-url]").click(function(){var a=$(this),b=parseInt(a.data("width")||420),c=parseInt(a.data("height")||480),d=window.innerWidth/2-b/2,e=window.innerHeight/2-c/2,f=window.open(a.data("popup-url"),"freeDwnldSbscrb","status=1,width="+b+",height="+c+",left="+d+",top="+e);window.addEventListener("message",function(a){if(a.source==f){var b=a.data;f.close(),b.error&&toastr.error(b.error,"",{positionClass:"toast-top-center"}),b.link&&showSuccess(b.link),b.auth&&($(".js-socials-close").click(),openSigninModal(null,b.auth))}})}),addEmailFormListener();